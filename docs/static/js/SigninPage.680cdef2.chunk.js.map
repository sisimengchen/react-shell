{"version":3,"sources":["webpack:///./src/agent/auth.js","webpack:///./src/agent/index.js","webpack:///./src/components/waiting/index.jsx","webpack:///./src/pages/Signin/index.jsx"],"names":["signin","data","arguments","length","undefined","request","post","url","then","setToken","token","User","get","signout","__webpack_require__","d","__webpack_exports__","auth_signin","auth_signout","Waiting","react_default","a","createElement","className","SigninPage","props","_this","classCallCheck_default","this","possibleConstructorReturn_default","getPrototypeOf_default","call","defineProperty_default","assertThisInitialized_default","_this$state","state","accountid","password","setState","loading","target","history","replace","window","location","origin","catch","error","query","onClick","components_waiting","PureComponent","connect","_ref","objectSpread_default","dispatch","payload","type"],"mappings":"sHAIaA,EAAS,eAACC,EAADC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAQ,GAAR,OAAeG,IAAQC,KAAK,CAAEC,IAAK,aAAcN,SAAQO,KAAK,WAAe,IAAdP,EAAcC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,GAE1F,OADAO,YAASR,EAAKS,OACPC,IAAKC,KAAI,MAQLC,EAAU,kBAAMR,IAAQC,KAAK,CAAEC,IAAK,gBAAiBC,KAAK,kBAAMC,YAAS,SCdtFK,EAAAC,EAAAC,EAAA,sBAAAC,IAAAH,EAAAC,EAAAC,EAAA,sBAAAE,8QCaeC,UANC,kBACdC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,sBACbH,EAAAC,EAAAC,cAAA,gBCFEE,sBACJ,SAAAA,EAAYC,GAAO,IAAAC,EAAAC,IAAAC,KAAAJ,GACjBE,EAAAG,IAAAD,KAAAE,IAAAN,GAAAO,KAAAH,KAAMH,IADWO,IAAAC,IAAAP,GAAA,SAWV,WAAM,IAAAQ,EACmBR,EAAKS,MAA7BC,EADKF,EACLE,UAAWC,EADNH,EACMG,SACnBX,EAAKY,SAAS,CACZC,SAAS,IAEXvC,YAAO,CACLoC,YACAC,aAEC7B,KAAK,SAACP,GACLyB,EAAKD,MAAMzB,OAAOC,GAClByB,EAAKY,SACH,CACEC,SAAS,GAEX,WAAM,IACIC,EAAWd,EAAKS,MAAhBK,OACRC,IAAQC,QAAQF,EAAOE,QAAQC,OAAOC,SAASC,OAAQ,SAI5DC,MAAM,SAACC,GACNrB,EAAKY,SAAS,CACZC,SAAS,QAlCE,IAETS,EAAUvB,EAAMmB,SAAhBI,MAFS,OAGjBtB,EAAKS,MAAQ,CACXK,OAAQQ,EAAMR,QAAU,IACxBD,SAAS,EACTH,UAAW,YACXC,SAAU,YAPKX,wDAuCV,IACCa,EAAYX,KAAKO,MAAjBI,QACR,OACEnB,EAAAC,EAAAC,cAAA,OAAKC,UAAU,gBACbH,EAAAC,EAAAC,cAAA,UAAQ2B,QAASrB,KAAK5B,QAAtB,4BACCuC,GAAWnB,EAAAC,EAAAC,cAAC4B,EAAD,cA7CKC,kBA4DVC,sBATS,SAAAC,GAAA,IAAGpD,EAAHoD,EAAGpD,KAAH,OAAAqD,IAAA,GACnBrD,IAGsB,SAAAsD,GAAQ,MAAK,CACtCvD,OAAQ,eAACwD,EAADtD,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAW,GAAX,OAAkBqD,EAAS,CAAEE,KAAM,SAAUD,QAASA,OAIjDJ,CAGb5B","file":"static/js/SigninPage.680cdef2.chunk.js","sourcesContent":["import { setToken } from 'utils/token';\nimport { User } from 'utils/user';\nimport { request } from 'utils/request';\n\nexport const signin = (data = {}) => request.post({ url: '/api/login', data }).then((data = {}) => {\n  setToken(data.token);\n  return User.get(true);\n});\n\nexport const register = (data = {}) => request.post({ url: '/api/register', data }).then((data = {}) => {\n  setToken(data.token);\n  return User.get(true);\n});\n\nexport const signout = () => request.post({ url: '/api/logout' }).then(() => setToken(null));\n","export * from './auth';\n","/**\n * @file 等候组件\n * @author mengchen <sisimengchen@gmail.com>\n */\nimport React from 'react';\nimport './index.scss';\n\nconst Waiting = () => (\n  <div className=\"components-waiting\">\n    <span />\n  </div>\n);\n\nexport default Waiting;\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport history from 'core/history';\nimport { signin } from 'agent';\nimport Waiting from 'components/waiting';\nimport './index.scss';\n\nclass SigninPage extends PureComponent {\n  constructor(props) {\n    super(props);\n    const { query } = props.location;\n    this.state = {\n      target: query.target || '/',\n      loading: false,\n      accountid: 'accountid',\n      password: 'password'\n    };\n  }\n\n  signin = () => {\n    const { accountid, password } = this.state;\n    this.setState({\n      loading: true\n    });\n    signin({\n      accountid,\n      password\n    })\n      .then((data) => {\n        this.props.signin(data);\n        this.setState(\n          {\n            loading: false\n          },\n          () => {\n            const { target } = this.state;\n            history.replace(target.replace(window.location.origin, ''));\n          }\n        );\n      })\n      .catch((error) => {\n        this.setState({\n          loading: false\n        });\n      });\n  };\n\n  render() {\n    const { loading } = this.state;\n    return (\n      <div className=\"pages-signin\">\n        <button onClick={this.signin}>一键登录</button>\n        {loading && <Waiting />}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ data }) => ({\n  ...data\n});\n\nconst mapDispatchToProps = dispatch => ({\n  signin: (payload = {}) => dispatch({ type: 'SIGNIN', payload: payload })\n  // updateData: (payload = {}) => dispatch({ type: 'UPDATE_DATA', payload })\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SigninPage);\n"],"sourceRoot":""}