{"version":3,"sources":["webpack:///./src/agent/auth.js","webpack:///./src/agent/index.js","webpack:///./src/pages/Test/index.jsx"],"names":["signin","data","arguments","length","undefined","request","post","url","then","setToken","token","User","get","signout","__webpack_require__","d","__webpack_exports__","auth_signin","auth_signout","TestPage","props","_this","_babel_runtime_corejs3_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default","this","_babel_runtime_corejs3_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default","_babel_runtime_corejs3_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default","call","_babel_runtime_corejs3_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_7___default","_babel_runtime_corejs3_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default","_context","_this$props$location","location","pathname","search","target","concat","encodeURIComponent","_babel_runtime_corejs3_core_js_stable_instance_concat__WEBPACK_IMPORTED_MODULE_0___default","history","replace","query","state","testid","react__WEBPACK_IMPORTED_MODULE_8___default","a","createElement","className","userId","userName","onClick","PureComponent","connect","_ref","currentUser","id","name","dispatch","type"],"mappings":"sHAIaA,EAAS,eAACC,EAADC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAQ,GAAR,OAAeG,IAAQC,KAAK,CAAEC,IAAK,aAAcN,SAAQO,KAAK,WAAe,IAAdP,EAAcC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,GAE1F,OADAO,YAASR,EAAKS,OACPC,IAAKC,KAAI,MAQLC,EAAU,kBAAMR,IAAQC,KAAK,CAAEC,IAAK,gBAAiBC,KAAK,kBAAMC,YAAS,SCdtFK,EAAAC,EAAAC,EAAA,sBAAAC,IAAAH,EAAAC,EAAAC,EAAA,sBAAAE,yPCMMC,sBACJ,SAAAA,EAAYC,GAAO,IAAAC,EAAAC,IAAAC,KAAAJ,GACjBE,EAAAG,IAAAD,KAAAE,IAAAN,GAAAO,KAAAH,KAAMH,IADWO,IAAAC,IAAAP,GAAA,UAQT,WACRR,cAAUL,KAAK,WAAM,IAAAqB,EACnBR,EAAKD,MAAMP,UADQ,IAAAiB,EAEUT,EAAKD,MAAMW,SAAhCC,EAFWF,EAEXE,SAAUC,EAFCH,EAEDG,OACZC,EAAM,UAAAC,OAAaC,mBAAmBC,IAAAR,EAAA,GAAAM,OAAGH,IAAJN,KAAAG,EAAeI,KAC1DK,IAAQC,QAAQ,CACdP,SAAU,UACVC,OAAQC,EAAM,IAAAC,OAAOD,GAAW,SAfnB,IAETM,EAAUpB,EAAMW,SAAhBS,MAFS,OAGjBnB,EAAKoB,MAAQ,CACXC,OAAQF,EAAME,QAJCrB,wDAoBV,IACCqB,EAAWnB,KAAKkB,MAAhBC,OACR,OACEC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,cAAf,iCACQJ,EACNC,EAAAC,EAAAC,cAAA,UACEF,EAAAC,EAAAC,cAAA,oBAAYtB,KAAKH,MAAM2B,QACvBJ,EAAAC,EAAAC,cAAA,sBAActB,KAAKH,MAAM4B,WAE3BL,EAAAC,EAAAC,cAAA,UAAQI,QAAS1B,KAAKV,SAAtB,wBA9BeqC,kBA6CRC,sBATS,SAAAC,GAAA,IAAGC,EAAHD,EAAGC,YAAH,MAAsB,CAC5CN,OAAQM,EAAYC,GACpBN,SAAUK,EAAYE,OAGG,SAAAC,GAAQ,MAAK,CACtC3C,QAAS,kBAAM2C,EAAS,CAAEC,KAAM,eAGnBN,CAGbhC","file":"static/js/TestPage.07a21103.chunk.js","sourcesContent":["import { setToken } from 'utils/token';\nimport { User } from 'utils/user';\nimport { request } from 'utils/request';\n\nexport const signin = (data = {}) => request.post({ url: '/api/login', data }).then((data = {}) => {\n  setToken(data.token);\n  return User.get(true);\n});\n\nexport const register = (data = {}) => request.post({ url: '/api/register', data }).then((data = {}) => {\n  setToken(data.token);\n  return User.get(true);\n});\n\nexport const signout = () => request.post({ url: '/api/logout' }).then(() => setToken(null));\n","export * from './auth';\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport history from 'core/history';\nimport { signout } from 'agent';\nimport './index.scss';\n\nclass TestPage extends PureComponent {\n  constructor(props) {\n    super(props);\n    const { query } = props.location;\n    this.state = {\n      testid: query.testid\n    };\n  }\n\n  signout = () => {\n    signout().then(() => {\n      this.props.signout();\n      const { pathname, search } = this.props.location;\n      const target = `target=${encodeURIComponent(`${pathname}${search}`)}`;\n      history.replace({\n        pathname: '/signin',\n        search: target ? `?${target}` : ''\n      });\n    });\n  };\n\n  render() {\n    const { testid } = this.state;\n    return (\n      <div className=\"pages-test\">\n        我是测试页{testid}\n        <ul>\n          <li>userId:{this.props.userId}</li>\n          <li>userName:{this.props.userName}</li>\n        </ul>\n        <button onClick={this.signout}>注销</button>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ currentUser }) => ({\n  userId: currentUser.id,\n  userName: currentUser.name\n});\n\nconst mapDispatchToProps = dispatch => ({\n  signout: () => dispatch({ type: 'SIGNOUT' })\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TestPage);\n"],"sourceRoot":""}